<!doctype html>
<html lang="ru">
<head>
    <meta charset="utf-8" />
    <title>Теория языков программирования и методы трансляции</title>
    <link rel="stylesheet" href="style.css" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.7.2/styles/default.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.7.2/highlight.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.7.2/languages/go.min.js"></script>
    <script>hljs.highlightAll();</script>
</head>
<body>
<h1 class="title">RegExp</h1>
<div class="data">
<div class="fio">
    <p>ФИО студента:</p>
    <p>Белошапка Н.Г.</p>
    <p>Преподаватель:</p>
    <p>Романенко В.В</p>
</div>
<div class="example">
    <p>Теория языков программирования и методы трансляции</p>
    <p>Лабораторная работа №1</p>
    <p>Вариант №3</p>
</div>
</div>
<div class="inputBlock">
    <input type="text" size="80">
    <input type="button" onclick="regExp()" value="Проверить">
    <input type="button" onclick="clearAreas()" value="Сбросить">
</div>

<div class="outputBlock">
    <div class="userText">Вы ввели</div>
    <div class="result">Результат</div>
</div>

<div class="code">Код программы</div>


<pre><code class="language-js">   Код JS
</code></pre>

<script type="text/javascript">

    document.getElementsByClassName('language-js')[0].innerHTML = regExp

    function clearAreas(){
        document.getElementsByClassName('userText')[0].innerHTML = "Вы ввели"
        document.getElementsByClassName('result')[0].innerHTML = "Результат"
        document.getElementsByClassName('code')[0].innerHTML = "Код программы"
        document.getElementsByTagName("input")[0].value = ""
    }

    function regExp(){

        let inputText = document.getElementsByTagName("input")[0];
        let textVal = inputText.value;
        console.log(textVal)
        if (textVal !== ""){


            let str = textVal
            //"const t = 0;"
            let result = str.match(/((let|const)|(?<err2>.*))\s(\D\w*|(?<err>.*))\s=\s\d*/)
            if (result == null){
                console.log(`ошибка в первой позиции`)
                document.getElementsByClassName('result')[0].innerHTML = "ошибка в первой позиции"
                inputText.value = ""
                return false
            }
            let groups = str.match(/((let|const)|(?<err2>.*))\s(\D\w*|(?<err>.*))\s=\s\d*/).groups;

            console.log(result)
            console.log(groups.err)
            console.log(str.length)

            let arrayOfError = []
            if(groups.err !== undefined){
                for (let i = 0; i < str.length; i++){
                    console.log(str[i])
                    if (str[i] == groups.err[0]){
                        for (let j = 0, c = i; j < groups.err.length; j++, c++){
                            if (str[c] == groups.err[j] && arrayOfError.length !== groups.err.length){
                                arrayOfError.push(c)
                                console.log(`ошибка найдена в позиции ${c}`)
                            }
                        }
                    }
                }
            }


            console.log(arrayOfError)
            if (arrayOfError.length > 0){
                console.log(`ошибка найдена в позиции ${arrayOfError[0]}`)
                document.getElementsByClassName('result')[0].innerHTML = `ошибка найдена в позиции ${arrayOfError[0] + 1}`
            } else {
                console.log(`ошибок не найдено`)
                document.getElementsByClassName('result')[0].innerHTML = "ошибок не найдено"
            }









            if(groups.err2 !== undefined) {
                for (let i = 0; i < str.length; i++) {
                    if (str[i] == groups.err2[0]) {
                        for (let j = 0, c = i; j < groups.err2.length; j++, c++) {
                            if (str[c] == groups.err2[j] && arrayOfError.length !== groups.err2.length) {
                                arrayOfError.push(c)

                            }
                        }
                    }
                }

                let arrLet = ["l", "e", "t"]
                let arrConst = ["c", "o", "n", "s", "t"]
                let err2Let = []
                let err2Const = []
                if (groups.err2 !== undefined) {
                    console.log(groups.err2)
                    // проверяем на let
                    for (let i = 0; i < arrLet.length; i++) {
                        if (err2Let.length == 0) {
                            console.log(groups.err2[i])
                            arrLet[i] == groups.err2[i] ? console.log(arrLet[i]) : err2Let = [groups.err2[i], i]
                        }

                    }

                    // проверяем на const
                    for (let i = 0; i < arrConst.length; i++) {
                        if (err2Const.length == 0) {
                            console.log(groups.err2[i])
                            arrConst[i] == groups.err2[i] ? console.log(arrConst[i]) : err2Const = [groups.err2[i], i]
                            console.log(i)
                            console.log(arrConst.length)
                            if (i == arrConst.length - 1) {
                                err2Const = [groups.err2[i + 1], i + 1]
                            }
                            console.log(err2Const)
                            console.log(121212)
                        }
                    }
                }

                if (err2Let[0] == err2Const[0]) {
                    console.log("ошибка в позиции 1")
                    document.getElementsByClassName('result')[0].innerHTML = "ошибка в позиции 1"
                } else if (err2Let[0] == "c") {
                    let resLet = (Number.parseInt(err2Const[1])) + 1


                    console.log(`ошибка в позиции ${resLet}`)
                    document.getElementsByClassName('result')[0].innerHTML = `ошибка в позиции ${resLet}`
                } else {
                    let resConst = (Number.parseInt(err2Let[1])) + 1
                    console.log(`ошибка в позиции ${resConst}`)
                    document.getElementsByClassName('result')[0].innerHTML = `ошибка в позиции ${resConst}`
                }

                console.log(err2Let)
                console.log(err2Const)
                console.log(err2Const[1])
                console.log(err2Let[1])
            }

































            inputText.value = ""

            document.getElementsByClassName('userText')[0].innerHTML = textVal
        }
    }

</script>
</body>
</html>